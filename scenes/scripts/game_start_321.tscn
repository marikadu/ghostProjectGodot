[gd_scene load_steps=6 format=3 uid="uid://qu06wlu637ji"]

[ext_resource type="Theme" uid="uid://dti72e04ltog4" path="res://game.theme" id="1_nh8ac"]

[sub_resource type="GDScript" id="GDScript_84e7d"]
script/source = "extends Node
## \"get ready\" timer

# slow down time
# Engine.time_scale = 0.5 (would be cool for lose screen)

# have an option to turn this off in settings!!!!!!

@onready var label = $Label
@onready var game_start_timer: Timer = $GameStartTimer
@onready var animation_player: AnimationPlayer = $AnimationPlayer

var time_left

func _ready() -> void:
	
	Events.resume_game.connect(_on_resume_game)
	
	#get_tree().paused = true
	#label.visible = true
	#game_start_timer.start()
	#$SecondTimer.start()
	#animation_player.play(\"zoom_out\")
	#pass
	

func time_until_game_start():
	time_left = game_start_timer.time_left
	var second = int(time_left) % 60
	#return [minute, second]
	return [second]
	


func _process(_delta: float) -> void:
	#label.text = \"%02d:%02d\" % time_left_until_win()
	label.text = \"%2d\" % time_until_game_start()
	
	#if game_start_timer.time_left < 1.0:
		#print(\"timer bye\")
		#self.visible = false 
		#get_tree().paused = false
	


#func _on_game_start_timer_timeout() -> void:
	#label.visible = false
	##queue_free()
	#pass # Replace with function body.
	
func _on_resume_game():
	print(\"resuming game!\")
	label.visible = true
	game_start_timer.start()
	$SecondTimer.start()
	animation_player.play(\"zoom_out\")


func _on_second_timer_timeout() -> void:
	animation_player.play(\"zoom_out\")
	print(\"second1\")
	if game_start_timer.time_left < 1.0:
		print(\"timer bye\")
		label.visible = false
		get_tree().paused = false
		
		game_start_timer.stop()
		$SecondTimer.stop()
"

[sub_resource type="Animation" id="Animation_g4lqp"]
resource_name = "zoom_out"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:scale")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.966667),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector2(1, 1), Vector2(0.81, 0.81)]
}

[sub_resource type="Animation" id="Animation_bq4pl"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:scale")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(1, 1)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_y2bv6"]
_data = {
"RESET": SubResource("Animation_bq4pl"),
"zoom_out": SubResource("Animation_g4lqp")
}

[node name="GameStartTimer" type="Control"]
process_mode = 3
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = SubResource("GDScript_84e7d")

[node name="Label" type="Label" parent="."]
layout_mode = 1
anchors_preset = 5
anchor_left = 0.5
anchor_right = 0.5
offset_left = -68.0
offset_top = 341.0
offset_right = 68.0
offset_bottom = 411.0
grow_horizontal = 2
pivot_offset = Vector2(67, 34)
size_flags_horizontal = 4
size_flags_vertical = 0
theme = ExtResource("1_nh8ac")
theme_override_font_sizes/font_size = 51
text = "0"
horizontal_alignment = 1

[node name="GameStartTimer" type="Timer" parent="."]
wait_time = 4.0

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
root_node = NodePath("../Label")
libraries = {
"": SubResource("AnimationLibrary_y2bv6")
}

[node name="SecondTimer" type="Timer" parent="."]

[connection signal="timeout" from="SecondTimer" to="." method="_on_second_timer_timeout"]
